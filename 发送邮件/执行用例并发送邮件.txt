from HTMLTestRunner import HTMLTestRunner
import unittest
import smtplib
from email.mime.text import MIMEText
from email.header import Header

#加载所有用例
# tests = unittest.defaultTestLoader.discover(r"D:\pythoncode\demo\python\day13",pattern="TestCalc.py")

#创建运行器
# runner = HTMLTestRunner.HTMLTestRunner(
#     title="计算器的测试报告",
#     description="计算机加减乘除的测试报告",
#     verbosity=1,
#     stream=open(file="计算器.html",mode="w+",encoding = "utf-8")
# )
#执行用例
# runner.run(tests)
#发送邮件

#第三方SMTP服务
auth_passport = "qkvstcypamoafahg"
server = smtplib.SMTP()
server.connect("smtp.qq.com")
server.login("2082588993@qq.com", auth_passport)

sender = "2082588993@qq.com"
receivers = "2431320433@qq.com"
subject = "计算器的测试报告"

# mail_msg = """
# <p>Python 邮件发送测试...</p>
# <p><a href="http://计算器.html">计算机测试报告的连接</a></p>
# """
file = open(r"D:\pythoncode\demo\python\day13\计算器.html", "rb")
msg = file.read()
file.close()
message = MIMEText(msg, "html", "utf-8")
message['Subject'] = Header(subject, 'utf-8')

server.sendmail(sender, receivers, message.as_string())

server.quit()
